<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kanban Board</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Syne:wght@600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,400&display=swap"
    rel="stylesheet"
  />

  <link rel="stylesheet" href="/static/css/style.css" />
</head>

<body>
  <!--  APP SHELL                                                     
  <!-- Top navigation bar -->
  <header class="app-header" role="banner">
    <div class="header-inner">
      <!-- Logo / branding -->
      <div class="header-brand">
        <span class="brand-icon" aria-hidden="true">⬡</span>
        <span class="brand-name">FlowBoard</span>
      </div>

    Board title (editable in future iterations)
      <h1 class="board-title">My Workspace</h1>

      Header actions
      <div class="header-actions">
        <button
          id="btn-add-column"
          class="btn btn--ghost"
          aria-label="Add a new column"
          title="Add column"
        >
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
            <path d="M8 1.5a.75.75 0 0 1 .75.75v5h5a.75.75 0 0 1 0 1.5h-5v5a.75.75 0 0 1-1.5 0v-5h-5a.75.75 0 0 1 0-1.5h5v-5A.75.75 0 0 1 8 1.5Z"/>
          </svg>
          Add Column
        </button>
      </div>
    </div>
  </header>

  <!-- Main board canvas — horizontal scroll for overflow columns -->
  <main class="board-canvas" id="board-canvas" role="main">

    <!-- Loading skeleton shown while API call is in-flight -->
    <div class="loading-state" id="loading-state" aria-live="polite" aria-busy="true">
      <div class="spinner" aria-hidden="true"></div>
      <p>Loading your board…</p>
    </div>

    <!-- Error state shown if initial fetch fails -->
    <div class="error-state hidden" id="error-state" role="alert">
      <p>⚠️ Could not load the board. Please refresh the page.</p>
    </div>

    <!-- Columns are injected here dynamically by script.js -->
    <div class="columns-container" id="columns-container" role="list">
      <!-- Column elements are created at runtime -->
    </div>

    <!-- "Add column" inline quick-entry at the end of the row -->
    <div class="column-add-panel" id="column-add-panel">
      <form class="column-add-form hidden" id="column-add-form" novalidate>
        <input
          type="text"
          id="new-column-title"
          class="column-add-input"
          placeholder="Column name…"
          maxlength="120"
          autocomplete="off"
          aria-label="New column name"
        />
        <div class="column-add-actions">
          <button type="submit" class="btn btn--primary btn--sm">Add Column</button>
          <button type="button" class="btn btn--ghost btn--sm" id="btn-cancel-add-column">
            Cancel
          </button>
        </div>
      </form>
    </div>

  </main>


  <!--  CARD DETAIL MODAL                                              -->
  <dialog
    class="modal"
    id="card-modal"
    aria-labelledby="modal-card-title"
    aria-modal="true"
  >
    <div class="modal-inner">

      <!-- Modal header -->
      <div class="modal-header">
        <h2 class="modal-heading" id="modal-card-title">Edit Card</h2>
        <button
          class="btn btn--ghost btn--icon modal-close"
          id="modal-close-btn"
          aria-label="Close dialog"
        >
          <svg width="18" height="18" viewBox="0 0 18 18" fill="currentColor" aria-hidden="true">
            <path d="M13.78 4.22a.75.75 0 0 1 0 1.06L10.06 9l3.72 3.72a.75.75 0 1 1-1.06 1.06L9 10.06l-3.72 3.72a.75.75 0 0 1-1.06-1.06L7.94 9 4.22 5.28a.75.75 0 0 1 1.06-1.06L9 7.94l3.72-3.72a.75.75 0 0 1 1.06 0Z"/>
          </svg>
        </button>
      </div>

      <!-- Modal body — card edit form -->
      <form class="modal-form" id="card-edit-form" novalidate>
        <!-- Hidden card ID -->
        <input type="hidden" id="modal-card-id" />

        
        <!-- Title field -->
        <div class="form-group">
          <label class="form-label" for="modal-title">Title</label>
          <input
            type="text"
            id="modal-title"
            class="form-input"
            placeholder="What needs to be done?"
            maxlength="500"
            required
          />
          <span class="form-hint char-counter" id="title-char-counter">0 / 500</span>
        </div>

        
        <!-- Description field -->
        <div class="form-group">
          <label class="form-label" for="modal-description">Description</label>
          <textarea
            id="modal-description"
            class="form-textarea"
            placeholder="Add more detail…"
            rows="4"
          ></textarea>
        </div>

        
        <!-- Label colour picker -->
        <div class="form-group">
          <label class="form-label">Label Colour</label>
          <div class="color-swatches" role="group" aria-label="Label colour options">
            <button type="button" class="swatch" data-color="null" aria-label="No colour">
              <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                <line x1="2" y1="12" x2="12" y2="2"/>
                <rect x="1" y="1" width="12" height="12" rx="3"/>
              </svg>
            </button>
            <button type="button" class="swatch" data-color="#ef4444" style="background:#ef4444" aria-label="Red"></button>
            <button type="button" class="swatch" data-color="#f97316" style="background:#f97316" aria-label="Orange"></button>
            <button type="button" class="swatch" data-color="#eab308" style="background:#eab308" aria-label="Yellow"></button>
            <button type="button" class="swatch" data-color="#22c55e" style="background:#22c55e" aria-label="Green"></button>
            <button type="button" class="swatch" data-color="#3b82f6" style="background:#3b82f6" aria-label="Blue"></button>
            <button type="button" class="swatch" data-color="#8b5cf6" style="background:#8b5cf6" aria-label="Purple"></button>
            <button type="button" class="swatch" data-color="#ec4899" style="background:#ec4899" aria-label="Pink"></button>
          </div>
        </div>

        
        <!-- Form actions -->
        <div class="modal-footer">
          <button type="submit" class="btn btn--primary" id="modal-save-btn">Save Changes</button>
          <button
            type="button"
            class="btn btn--danger btn--ghost"
            id="modal-delete-btn"
          >Delete Card</button>
        </div>

        <!-- Inline feedback message -->
        <p class="form-feedback hidden" id="modal-feedback" role="alert"></p>
      </form>
    </div>
  </dialog>

  <!-- Backdrop click closes modal (handled by JS) -->
  <div class="modal-backdrop hidden" id="modal-backdrop" aria-hidden="true"></div>


  <!--  TOAST NOTIFICATION CONTAINER                                   -->
  <div
    class="toast-container"
    id="toast-container"
    role="region"
    aria-label="Notifications"
    aria-live="polite"
  ></div>

  <!--  TEMPLATES — cloned by JS, never rendered directly              -->


  <!--
    Column template.
    JS clones this, fills in data-*, text content, and appends to #columns-container.
  -->
  <template id="tpl-column">
    <article class="kanban-column" role="listitem" draggable="true">
      <header class="column-header">
        <div class="column-header-left">
          <span class="column-badge" aria-label="Card count">0</span>
          <!-- Editable column title — double-click to rename -->
          <h2
            class="column-title"
            contenteditable="false"
            spellcheck="false"
            aria-label="Column title"
          ></h2>
        </div>
        <div class="column-header-actions">
          <button
            class="btn btn--ghost btn--icon btn-rename-column"
            aria-label="Rename column"
            title="Rename"
          >
            <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor" aria-hidden="true">
              <path d="M10.586 1a2 2 0 0 1 2.828 2.828l-7.9 7.9a1 1 0 0 1-.44.263l-2.5.714a.5.5 0 0 1-.617-.617l.714-2.5a1 1 0 0 1 .263-.44l7.652-7.648ZM11.293 2 4 9.293l-.429 1.5 1.5-.429L12.707 3 11.293 2Z"/>
            </svg>
          </button>
          <button
            class="btn btn--ghost btn--icon btn-delete-column"
            aria-label="Delete column"
            title="Delete column"
          >
            <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor" aria-hidden="true">
              <path d="M5.5 1h3a.5.5 0 0 1 .5.5V2h3a.5.5 0 0 1 0 1h-.5v9a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1V3H2a.5.5 0 0 1 0-1h3v-.5a.5.5 0 0 1 .5-.5ZM4 3v9h6V3H4Zm1.5 1.5a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Zm3 0a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
            </svg>
          </button>
        </div>
      </header>

      <!-- Cards drop zone -->
      <div class="cards-list" role="list" aria-label="Cards list"></div>

      
      <!-- Inline "add card" form -->
      <footer class="column-footer">
        <form class="add-card-form hidden" novalidate>
          <textarea
            class="add-card-input"
            placeholder="Card title…"
            maxlength="500"
            rows="2"
            aria-label="New card title"
          ></textarea>
          <div class="add-card-actions">
            <button type="submit" class="btn btn--primary btn--sm">Add Card</button>
            <button type="button" class="btn btn--ghost btn--sm btn-cancel-add-card">Cancel</button>
          </div>
        </form>
        <button class="btn btn--ghost btn--sm btn-show-add-card" aria-label="Add a card">
          <svg width="13" height="13" viewBox="0 0 13 13" fill="currentColor" aria-hidden="true">
            <path d="M6.5 1a.6.6 0 0 1 .6.6v4.3h4.3a.6.6 0 0 1 0 1.2H7.1v4.3a.6.6 0 0 1-1.2 0V7.1H1.6a.6.6 0 0 1 0-1.2h4.3V1.6A.6.6 0 0 1 6.5 1Z"/>
          </svg>
          Add a card
        </button>
      </footer>
    </article>
  </template>

  
  <!--
    Card template.
    JS clones this for each card object returned by the API.
  -->
  <template id="tpl-card">
    <div class="kanban-card" role="listitem" draggable="true" tabindex="0">
      <!-- Colour label strip at top of card -->
      <div class="card-label-strip" aria-hidden="true"></div>
      <div class="card-body">
        <p class="card-title"></p>
        <p class="card-description"></p>
      </div>
      <div class="card-footer">
        <span class="card-meta"></span>
        <button
          class="btn btn--ghost btn--icon btn-edit-card"
          aria-label="Edit card"
          title="Edit"
        >
          <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor" aria-hidden="true">
            <path d="M9.086.5a1.5 1.5 0 0 1 2.121 2.12l-6.83 6.83a.75.75 0 0 1-.33.197l-2.25.643a.375.375 0 0 1-.463-.463l.643-2.25a.75.75 0 0 1 .197-.33L9.086.5Z"/>
          </svg>
        </button>
      </div>
    </div>
  </template>

  
  <!-- Main JS bundle — deferred so HTML parses first -->
  <script src="/static/js/script.js" defer></script>
</body>
</html>
